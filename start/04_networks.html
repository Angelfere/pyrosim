

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Neural Network &mdash; pyrosim 0.1.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/icon32-scaled.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="pyrosim 0.1.1 documentation" href="../index.html"/>
        <link rel="up" title="Getting Started" href="../start.html"/>
        <link rel="next" title="Advanced Options" href="../advanced.html"/>
        <link rel="prev" title="Sensors" href="03_sensors.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pyrosim
          

          
          </a>

          
            
            
              <div class="version">
                0.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../start.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_empty.html">Simulator Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_body.html">Bodies</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_joints.html">Joints</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_sensors.html">Sensors</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Neural Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basics">Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sensor-neurons">Sensor Neurons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-input-neurons">Other Input Neurons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hidden-neurons">Hidden Neurons</a></li>
<li class="toctree-l4"><a class="reference internal" href="#motor-neurons">Motor Neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#updating">Updating</a></li>
<li class="toctree-l3"><a class="reference internal" href="#double-pendulum-part-iii">Double Pendulum Part III</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos.html">Videos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Simulator Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyrosim</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../start.html">Getting Started</a> &raquo;</li>
        
      <li>Neural Network</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="neural-network">
<span id="network"></span><h1>Neural Network<a class="headerlink" href="#neural-network" title="Permalink to this headline">¶</a></h1>
<p>Pyrosim currently only uses an artificial neural networks to control the robots.
This page is meant to be less of a tutorial on ANNs and more about pyrosim&#8217;s specific
implementation of ANNs. However, there should be enough information to supply a basic
understanding of how simple ANNs function. There are many resources for learning more
about neural networks and <a href="http://colah.github.io/" target="_blank">Christopher Olah's blog</a> is one of the prettier ones.</p>
<div class="section" id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>ANNs are directed networks where the nodes are called neurons and the edges
are called synapses (like a brain). They have many shapes and forms but will
generally consist of some variation of input, output, and hidden neurons.</p>
<p>Input neurons receive their node value from some pre-specified method (like sensory input).
The node values of the rest of the neurons are then updated based on the synaptic values coming from all of the input synapses. Synaptic values are calculated by multiplying the synaptic weight from the source neuron to the target neuron by the node value of the source neuron. These values are then computed using the <a class="reference internal" href="#update-rule"><span class="std std-ref">activation function</span></a> contained within the neuron. Most normally this is a summation of all the synaptic weight of all the inputs and a squashing function to keep the value within some range. The target neuron now contains its updated value and the rest of the network is updated in this same manner. After the network has been updated, node values are then generally read from the output neurons, giving the final result.</p>
<p>There are six built-in types of neurons in pyrosim</p>
<ol class="arabic simple">
<li>Sensor</li>
<li>Motor</li>
<li>Hidden</li>
<li>Bias</li>
<li>Function</li>
<li>User input</li>
</ol>
<p>The ANNs used for robotic control tend not to have the strict input output neurons
as in many networks used for machine learning. In pyrosim, the sensor, bias, function, and
user input neurons are all types of input neurons which receive their values
from different sources.</p>
<div class="section" id="sensor-neurons">
<h3>Sensor Neurons<a class="headerlink" href="#sensor-neurons" title="Permalink to this headline">¶</a></h3>
<p>Sensor neurons are updated based on the value of the specified sensor and <a class="reference internal" href="03_sensors.html#sensor-basics"><span class="std std-ref">svi</span></a>.
This value is inputed to the network raw, meaning no thresholding will occur.</p>
<p>For example, if we want to input the distance from a ray sensor and the ray sensor has the id
<code class="code docutils literal"><span class="pre">ray_sensor_handle</span></code> we can use:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">dist_neuron</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">send_sensor_neuron</span><span class="p">(</span><span class="n">ray_sensor_handle</span><span class="p">,</span> <span class="n">svi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>This will send a neuron to the simulation which, at every time step,
reads the value from the ray sensor specified
by by <code class="code docutils literal"><span class="pre">ray_sensor_handle</span></code> at <code class="code docutils literal"><span class="pre">svi=0</span></code> (which is the distance component of the ray sensor)
and assumes that value.</p>
</div>
<div class="section" id="other-input-neurons">
<h3>Other Input Neurons<a class="headerlink" href="#other-input-neurons" title="Permalink to this headline">¶</a></h3>
<p>Bias, function, and user input neurons are the other types of input neurons. Unlike the sensor neuron
They recieve their input from outside the simulation. Bias neurons maintain a constant value of 1.
Function neurons get their value from a user-specified function mapped over the appropriate <code class="code docutils literal"><span class="pre">eval_time</span></code>
and <code class="code docutils literal"><span class="pre">dt</span></code>. Finally, user input neurons receive their value from a user-specified single value or
vector of values.</p>
</div>
<div class="section" id="hidden-neurons">
<h3>Hidden Neurons<a class="headerlink" href="#hidden-neurons" title="Permalink to this headline">¶</a></h3>
<p>Hidden neurons are basic neuron units which update according to the normal rules. They are called
&#8216;hidden&#8217; because there value at any given time step is not known or important to the user.</p>
</div>
<div class="section" id="motor-neurons">
<h3>Motor Neurons<a class="headerlink" href="#motor-neurons" title="Permalink to this headline">¶</a></h3>
<p>Motor neurons are the closest thing to traditional output neurons in pyrosim. The value of the motor neuron
is read by the specified joint and then the joint actuates accordingly.</p>
<p><strong>Notes about motor neurons and joints</strong>:</p>
<blockquote>
<div><ul class="simple">
<li>Motor neurons which are not connected by synapses will have a constant value of 0. This means they will try to keep the joint at the midpoint of the joint range if the joint is using position control or at velocity 0 if not. Changing the <code class="code docutils literal"><span class="pre">torque</span></code> parameter of the joint will change how effective the joint is at maintaining its position.</li>
<li>If a motor neuron is attached to a joint which is using positional control, it is important to be wary of where the joint is initialized in relation to its limits. If the starting point of the joint is near its <code class="code docutils literal"><span class="pre">hi</span></code> or <code class="code docutils literal"><span class="pre">lo</span></code> cutoffs, the joint will immediately try to position to the midpoint of its range and the simulation will most likely break. <em>(Still mostly untested) This problem can be partially mitigated by changing the</em> <code class="code docutils literal"><span class="pre">start_value</span></code> <em>parameter when specifying the motor neuron</em>. If the joint is not using position control then this is not a problem.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="updating">
<span id="update-rule"></span><h2>Updating<a class="headerlink" href="#updating" title="Permalink to this headline">¶</a></h2>
<p>Hidden and motor neurons are updated every time step based on the input values
and the value of the neuron at the previous time step. The activation function is as
follows:</p>
<div class="math">
\[n_i^{(t)} = \sigma\left(\alpha n_i^{(t-1)} + \tau \sum_{j\in J} w_{ji} n_j^{(t-1)}\right)\]</div>
<p>Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(n_i^{(t)}\)</span> - neuron <span class="math">\(i\)</span> at time step <span class="math">\(t\)</span>.</li>
<li><span class="math">\(J\)</span> - the set of neurons which input to <span class="math">\(n_i\)</span>.</li>
<li><span class="math">\(w_{ji}\)</span> - the synaptic weight from neuron <span class="math">\(j\)</span> to <span class="math">\(i\)</span></li>
<li><span class="math">\(\alpha,\tau\)</span> - user defined learning parameters. Usually 0 or 1.</li>
<li><span class="math">\(\sigma\)</span> - a sigmoid function. Currently pyrosim only uses <span class="math">\(\mathbf{\tanh}\)</span>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="double-pendulum-part-iii">
<h2>Double Pendulum Part III<a class="headerlink" href="#double-pendulum-part-iii" title="Permalink to this headline">¶</a></h2>
<div class="literal-block-wrapper container" id="dp-network-py">
<div class="code-block-caption"><span class="caption-text">dp-network.py</span><a class="headerlink" href="#dp-network-py" title="Permalink to this code">¶</a></div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># network is designed to actuate hinge joints in</span>
<span class="c1"># response to the slider joint moving</span>
<span class="n">bias_neuron</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">send_bias_neuron</span><span class="p">()</span>
<span class="n">sensor_neuron</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">send_sensor_neuron</span><span class="p">(</span><span class="n">prop_sensor</span><span class="p">)</span>
<span class="n">motor_1_neuron</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">send_motor_neuron</span><span class="p">(</span><span class="n">world_joint</span><span class="p">)</span>
<span class="n">motor_2_neuron</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">send_motor_neuron</span><span class="p">(</span><span class="n">hinge_joint</span><span class="p">)</span>

<span class="c1"># simple synapses connect sensor to motor</span>
<span class="c1"># bias neurons get the ball rolling</span>
<span class="n">sim</span><span class="o">.</span><span class="n">send_synapse</span><span class="p">(</span><span class="n">bias_neuron</span><span class="p">,</span> <span class="n">motor_1_neuron</span><span class="p">,</span> <span class="o">.</span><span class="mi">001</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">send_synapse</span><span class="p">(</span><span class="n">bias_neuron</span><span class="p">,</span> <span class="n">motor_2_neuron</span><span class="p">,</span> <span class="o">.</span><span class="mi">001</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">send_synapse</span><span class="p">(</span><span class="n">sensor_neuron</span><span class="p">,</span> <span class="n">motor_1_neuron</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">send_synapse</span><span class="p">(</span><span class="n">sensor_neuron</span><span class="p">,</span> <span class="n">motor_2_neuron</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">wait_to_finish</span><span class="p">()</span>
</pre></div>
</div>
</div>
<iframe width="100%" height="315" src="https://www.youtube.com/embed/G_ZNbsSY0sI?rel=0" frameborder="0" allowfullscreen></iframe></div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../advanced.html" class="btn btn-neutral float-right" title="Advanced Options" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="03_sensors.html" class="btn btn-neutral" title="Sensors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Josh Bongard, Collin Cappelle, UVM MECL.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>